<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta content="width=device-width, user-scalable=yes, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"
          name="viewport">
    <meta content="ie=edge" http-equiv="X-UA-Compatible">
    <title>User login form</title>
    <meta content="noindex" name="robots">
    <link crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
          integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" rel="stylesheet">
    <script crossorigin="anonymous"
            integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

<main class="container mt-5">
    <h1>Login and deep linking</h1>
    <script>
        document.addEventListener('DOMContentLoaded', function (event) {
            let links = document.querySelectorAll('a'),
                    baseUri = 'exp://q7-esp.vergissberlin.react-native-deep-linking.exp.direct:80/'
            //baseUri = 'exp://192.168.10.16:19000/'

            /*
            let param = (new URL(document.location)).searchParams;
            baseUri = decodeURIComponent(param.get('linkingUri')) || baseUri;
            document.getElementById('result').innerText = baseUri;

            // Take the uri from the params
            let qs = decodeURIComponent(document.location.search)
            if (qs) {
                baseUri = qs.split('?linkingUri=')[1]
            }
            */

            // Update the link URLs
            for (var i = 0; i < links.length; ++i) {
                links[i].href = links[i].href.replace('exp://REPLACE_ME/', baseUri)
                console.log(links[i].href)
            }

            // URL params output
            let param = (new URL(document.location)).searchParams
            document.getElementById('result').innerText = decodeURIComponent(param.get('linkingUri'))

        })
    </script>
    <section class="section">
        <h2 class="mt-4">Auth redirect example</h2>
        <ul class="list-group">
            <li class="list-group-item">
                <a href="exp://REPLACE_ME/--/profile?authToken=6b7f432aa1cc001fa2e4116d011da8ec1f8d16c51f90231d9ecd6e9851dcb149021716e5417e99d56b24ad98433ac1dd7a0b">
                    Pass back some fake auth token
                </a>
            </li>
        </ul>
    </section>

    <section class="section">
        <h3 class="mt-5 text-muted">URL params</h3>
        <pre><code class="card text-muted p-2" id="result"></code></pre>
    </section>
</main>
</body>
</html>